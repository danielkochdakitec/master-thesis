\chapter{AWS Amplify}

Das folgende Kapitel beschreibt die Architektur und die Implementierung mit AWS Amplify.

\section{Architektur}

\subsection{Lösungsstrategie}

Die Architektur folgt dem Aufbau einer Drei"=Schichten"=Architektur:

\begin{itemize}
  \item Präsentationsschicht
    \begin{itemize}
      \item React.js
      \item amplify-js
    \end{itemize}
  \item Logikschicht
    \begin{itemize}
      \item AWS AppSync
      \item AWS Lambda
      \item Amazon Cognito
      \item AWS Elemental MediaConvert
      \item Amazon EventBridge
      \item AWS IAM
    \end{itemize}
  \item Datenhaltungsschicht
    \begin{itemize}
      \item Amazon DynamoDB
      \item Amazon S3
      \item Amazon Cognito
      \item AWS IAM
      \item AWS Backup
    \end{itemize}
\end{itemize}

Die Cloud-Dienste Amazon Cognito und AWS IAM befindet sich zugleich in zwei Schichten, da dort neben der Logik für Authentifizierung und Autorisierung auch die Benutzer persistiert werden.

Durch die ausschließliche Verwendung interner Cloud-Dienste, keiner Eigenentwicklungen für die Benutzerverwaltung und definierter Technologien sind die Rahmenbedingungen für dieses Projekt nicht missachtet, so dass die Vergleichbarkeit weiterhin gegeben ist.

\autoref{Kap2:Teildisziplinen} zeigt erste Lösungsansätze, um die nichtfunktionalen Anforderungen, auch Qualitätsziele genannt, zu erreichen.

\begin{table}[h]
  \caption{Lösungsansatz für nichtfunktionale Anforderungen}
  \label{Kap2:Teildisziplinen}
  \renewcommand{\arraystretch}{1.2}
  \centering
  \sffamily
  \begin{footnotesize}
    \begin{tabularx}{0.9\textwidth}{l l X}
      \toprule
      \textbf{Anforderung} & \textbf{Dienst} & \textbf{Ansatz}\\
      \midrule
        \emph{Verfügbarkeit} & AWS Amplify & AWS Amplify bietet für Frontend und Backend ein Zero-Downtime Deployment. \\
        \emph{Skalierbarkeit} & - & Durch die Serverless-Architektur skalieren Dienste automatisch innerhalb der \ac{AWS}-Cloud.\\
        \emph{Analysierbarkeit} & Amazon EventBridge & Durch den Einsatz von Amazon CloudWatch können Anfragen für jeden Cloud-Dienst nachvollzogen werden.\\
        \emph{Interoperabilität} & AWS AppSync & Durch den Einsatz von AWS AppSync ist mit GraphQL eine einheitliche Schnittstelle sichergestellt.\\
        \emph{Backups} & AWS Backup & Durch den Einsatz von AWS Backup werden automatisiert Backups aufgesetzt.\\
        \emph{Wiederherstellbarkeit} & AWS Backup &  Das von AWS Backup erstellte Backup für die Datenbank Amazon DynamoDB kann manuell eingespielt werden.\\
      \bottomrule
    \end{tabularx}
  \end{footnotesize}
  \rmfamily
\end{table}

\subsection{Bausteinsicht}

tbd grafik + beschreibung

\subsection{Laufzeitsicht}

tbd grafik + beschreibung

\subsection{Verteilungssicht}

tbd grafik + beschreibung

\subsection{Querschnittliche Konzepte und Muster}

- Einbindung über \ac{AWS} Amplify:
  - AWS Elemental MediaConvert als extra Plugin
  - Anpassung an CF-Templates
- Logging (Amazon CloudWatch)
- Permissions (IAM)
- AWS Backup

\subsection{Entwurfsentscheidungen}

\subsection{Risiken und technische Schulden}

- Auth: Anpassung, dass statt Identity ID die Pool User Id genutzt wird geht über https://github.com/aws-amplify/amplify-js/issues/54. Leider lässt sich das nicht persistieren, so dass man das bei jedem branch/Projekt neu eintragen muss. Wenn man es im CF-Template ändert, wird die Änderung beim Push rückgängig gemacht. Das ist nicht sehr flexibel. Ggf. Lösung finden und schauen, ob es doch geht.

- CDK als Alternative zu AWS Amplify, da es wesentlich flexibler

\section{Implementierung}